% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Query_method.R
\name{calculate_signature_score}
\alias{calculate_signature_score}
\title{Calculate Gene Signature Score for Single Cell Type}
\usage{
calculate_signature_score(
  expression_matrix,
  cell_type,
  disease_condition,
  metadata,
  celltype_column = "celltype",
  diagnosis_column = "Diagnosis"
)
}
\arguments{
\item{expression_matrix}{A numeric matrix with genes as rows and cells as columns.
Should be normalized/transformed expression data (e.g., output from normalization_by_gene).}

\item{cell_type}{Character string specifying the cell type to analyze.}

\item{disease_condition}{Character string specifying the disease condition 
(e.g., "IPF", "Control", etc.).}

\item{metadata}{A data.frame containing single-cell metadata with at least two columns:
- celltype: Cell type annotations for each cell
- Diagnosis: Disease condition for each cell
Rows should correspond to columns in expression_matrix.}

\item{celltype_column}{Character string specifying the column name in metadata 
containing cell type information. Default: "celltype".}

\item{diagnosis_column}{Character string specifying the column name in metadata 
containing diagnosis information. Default: "Diagnosis".}
}
\value{
A numeric value representing the average gene signature score for the 
  specified cell type and disease condition.
}
\description{
Calculates the average expression of a gene signature in a specific cell type
and disease condition from single-cell RNA-seq data.
}
\details{
The function:
1. Identifies cells matching the specified cell type and disease condition
2. Extracts expression data for those cells
3. Calculates the sum of all gene expression values
4. Divides by the number of cells to get the average signature score

Formula: signature_score = sum(all_gene_expression) / number_of_cells
}
\examples{
# Create example data
set.seed(123)
expr_data <- matrix(rnorm(50*200), nrow=50, ncol=200)
rownames(expr_data) <- paste0("Gene_", 1:50)
colnames(expr_data) <- paste0("Cell_", 1:200)

# Create metadata (all samples from same condition)
metadata <- data.frame(
  celltype = rep(c("T_cell", "B_cell", "Macrophage"), length.out=200),
  Diagnosis = "IPF"  # All samples from IPF condition
)

# Calculate signature score
score <- calculate_signature_score(expr_data, "T_cell", "IPF", metadata)

}
