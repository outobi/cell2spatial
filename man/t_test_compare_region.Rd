% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Region_specific_gene.R
\name{t_test_compare_region}
\alias{t_test_compare_region}
\title{T-Test Comparison for Spatial Regions}
\usage{
t_test_compare_region(
  expression_data,
  sample_metadata,
  target_region,
  sample_col = NULL,
  region_col = NULL,
  var_equal = FALSE,
  correction_method = "Nominal"
)
}
\arguments{
\item{expression_data}{A matrix or data frame of gene expression data with
genes as rows and samples as columns. Row names should be gene symbols,
column names should be sample IDs (S1, S2, S3, etc.)}

\item{sample_metadata}{A data frame with two columns:
Column 1: Sample IDs (S1, S2, S3, etc.) matching column names in expression_data
Column 2: Region types ("foci", "alveoli", "fibrosis", etc.)}

\item{target_region}{Character string specifying the target region type for comparison
(e.g., "foci", "alveoli", "fibrosis")}

\item{sample_col}{Character string specifying the column name for sample IDs
in sample_metadata (default: assumes first column)}

\item{region_col}{Character string specifying the column name for region types
in sample_metadata (default: assumes second column)}

\item{var_equal}{Logical. If TRUE, assumes equal variances (Student's t-test).
If FALSE (default), uses Welch's t-test which does not assume equal variances.}

\item{correction_method}{Character string specifying multiple testing correction method.
Options: "BH" for Benjamini-Hochberg FDR correction, "Nominal" for no correction (default: "Nominal")}
}
\value{
A data frame containing results for each gene:
  \item{gene_symbol}{Gene symbol from row names}
  \item{statistic}{The t-test statistic}
  \item{p.value}{P-value from the test (or FDR-adjusted p-value if correction_method = "BH")}
  \item{method}{The method used for the test}
  \item{target_region}{Target region in comparison}
  \item{comparison_group}{Comparison group description}
  \item{n_target}{Sample size of target region}
  \item{n_other}{Sample size of other regions}
  \item{cohens_d}{Cohen's d effect size}
  \item{mean_target}{Mean expression in target region}
  \item{mean_other}{Mean expression in other regions}
  \item{sd_target}{Standard deviation in target region}
  \item{sd_other}{Standard deviation in other regions}
}
\description{
Performs two-sample t-tests for comparing gene expression between spatial
regions in transcriptomics data, specifically designed for region-specific analysis.
Uses Cohen's d for effect size calculation.
}
\details{
This function performs two-sample t-tests to compare gene expression levels
between a target spatial region and all other regions combined. By default,
it uses Welch's t-test which does not assume equal variances.

Cohen's d is calculated as the standardized mean difference:
d = (mean_target - mean_other) / pooled_sd

For Welch's t-test, the pooled standard deviation is calculated as:
sqrt(((n1-1)*sd1^2 + (n2-1)*sd2^2) / (n1 + n2 - 2))

Effect size interpretation (Cohen's guidelines):
- |d| < 0.2: negligible
- 0.2 <= |d| < 0.5: small
- 0.5 <= |d| < 0.8: medium
- |d| >= 0.8: large
}
\examples{
\dontrun{
# Example with simulated data
set.seed(123)
# Expression data: 100 genes x 50 samples
expression_data <- matrix(rnorm(100 * 50), nrow = 100, ncol = 50)
rownames(expression_data) <- paste0("Gene_", 1:100)
colnames(expression_data) <- paste0("S", 1:50)

# Sample metadata
sample_metadata <- data.frame(
  sample_id = paste0("S", 1:50),
  region_type = rep(c("foci", "alveoli", "fibrosis"), c(20, 20, 10))
)

# Compare foci vs other regions
result <- t_test_compare_region(
  expression_data = expression_data,
  sample_metadata = sample_metadata,
  target_region = "foci"
)
head(result)
}

}
