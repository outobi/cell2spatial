% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Query_method.R
\name{calculate_multiple_signature_scores}
\alias{calculate_multiple_signature_scores}
\title{Calculate Gene Signature Scores for Multiple Cell Types}
\usage{
calculate_multiple_signature_scores(
  expression_matrix,
  cell_types,
  disease_condition,
  metadata,
  celltype_column = "celltype",
  diagnosis_column = "Diagnosis"
)
}
\arguments{
\item{expression_matrix}{A numeric matrix with genes as rows and cells as columns.}

\item{cell_types}{Character vector of cell type names to analyze.}

\item{disease_condition}{Character string specifying the disease condition.}

\item{metadata}{A data.frame containing single-cell metadata.}

\item{celltype_column}{Character string specifying the column name for cell types.}

\item{diagnosis_column}{Character string specifying the column name for diagnosis.}
}
\value{
A data.frame with columns:
  - Number: Sequential number (1 to length of cell_types)
  - Cell.type: Cell type names
  - signature.score: Calculated signature scores
}
\description{
Calculates gene signature scores for multiple cell types in a specific disease condition.
This is equivalent to your original loop-based approach but with better error handling.
}
\examples{
# Create example data
set.seed(123)
expr_data <- matrix(rnorm(50*300), nrow=50, ncol=300)
rownames(expr_data) <- paste0("Gene_", 1:50)
colnames(expr_data) <- paste0("Cell_", 1:300)

# Create metadata (all samples from same condition)
metadata <- data.frame(
  celltype = rep(c("T_cell", "B_cell", "Macrophage"), each=100),
  Diagnosis = "IPF"  # All samples from IPF condition
)

cell_types <- c("T_cell", "B_cell", "Macrophage")

# Calculate scores for all cell types
scores <- calculate_multiple_signature_scores(expr_data, cell_types, "IPF", metadata)

}
