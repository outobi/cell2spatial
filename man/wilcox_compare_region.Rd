% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Region_specific_gene.R
\name{wilcox_compare_region}
\alias{wilcox_compare_region}
\title{Wilcoxon Comparison Test for Spatial Regions}
\usage{
wilcox_compare_region(
  expression_data,
  sample_metadata,
  target_region,
  sample_col = NULL,
  region_col = NULL,
  correction_method = "Nominal"
)
}
\arguments{
\item{expression_data}{A matrix or data frame of gene expression data with
genes as rows and samples as columns. Row names should be gene symbols,
column names should be sample IDs (S1, S2, S3, etc.)}

\item{sample_metadata}{A data frame with two columns:
Column 1: Sample IDs (S1, S2, S3, etc.) matching column names in expression_data
Column 2: Region types ("foci", "alveoli", "fibrosis", etc.)}

\item{target_region}{Character string specifying the target region type for comparison
(e.g., "foci", "alveoli", "fibrosis")}

\item{sample_col}{Character string specifying the column name for sample IDs
in sample_metadata (default: assumes first column)}

\item{region_col}{Character string specifying the column name for region types
in sample_metadata (default: assumes second column)}

\item{correction_method}{Character string specifying multiple testing correction method.
Options: "BH" for Benjamini-Hochberg FDR correction, "Nominal" for no correction (default: "Nominal")}
}
\value{
A data frame containing results for each gene:
  \item{gene_symbol}{Gene symbol from row names}
  \item{statistic}{The Wilcoxon test statistic}
  \item{p.value}{P-value from the test (or FDR-adjusted p-value if correction_method = "BH")}
  \item{method}{The method used for the test}
  \item{target_region}{Target region in comparison}
  \item{comparison_group}{Comparison group description}
  \item{n_target}{Sample size of target region}
  \item{n_other}{Sample size of other regions}
  \item{effect_size}{Rank-biserial correlation effect size}
  \item{median_target}{Median expression in target region}
  \item{median_other}{Median expression in other regions}
}
\description{
Performs Wilcoxon rank-sum tests for comparing gene expression between spatial
regions in transcriptomics data, specifically designed for region-specific analysis.
}
\details{
This function performs Wilcoxon rank-sum tests (Mann-Whitney U tests) to compare
gene expression levels between a target spatial region and all other regions combined.
It's designed for spatial transcriptomics analysis where you want to identify
region-specific gene expression patterns.

The function processes each gene separately, comparing expression values from
samples in the target region versus samples from all other regions.
}
\examples{
\dontrun{
# Example with simulated data
set.seed(123)
# Expression data: 100 genes x 50 samples
expression_data <- matrix(rnorm(100 * 50), nrow = 100, ncol = 50)
rownames(expression_data) <- paste0("Gene_", 1:100)
colnames(expression_data) <- paste0("S", 1:50)

# Sample metadata
sample_metadata <- data.frame(
  sample_id = paste0("S", 1:50),
  region_type = rep(c("foci", "alveoli", "fibrosis"), c(20, 20, 10))
)

# Compare foci vs other regions
result <- wilcox.comp(
  expression_data = expression_data,
  sample_metadata = sample_metadata,
  target_region = "foci"
)
head(result)
}

}
