% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Query_method.R
\name{query_signature_comprehensive}
\alias{query_signature_comprehensive}
\title{Query Gene Signature Across Conditions and Cell Types}
\usage{
query_signature_comprehensive(
  expression_matrix,
  cell_types,
  disease_conditions,
  metadata,
  celltype_column = "celltype",
  diagnosis_column = "Diagnosis",
  include_stats = FALSE
)
}
\arguments{
\item{expression_matrix}{A numeric matrix with genes as rows and cells as columns.}

\item{cell_types}{Character vector of cell type names to analyze.}

\item{disease_conditions}{Character vector of disease conditions to compare.}

\item{metadata}{A data.frame containing single-cell metadata.}

\item{celltype_column}{Character string specifying the column name for cell types.}

\item{diagnosis_column}{Character string specifying the column name for diagnosis.}

\item{include_stats}{Logical. If TRUE, includes additional statistics. Default: FALSE.}
}
\value{
A data.frame with signature scores for each cell type and condition combination.
}
\description{
Advanced function to query gene signatures across multiple cell types and conditions.
Provides comprehensive analysis similar to your original approach.
}
\examples{
# Create example data
set.seed(123)
expr_data <- matrix(rnorm(50*400), nrow=50, ncol=400)
rownames(expr_data) <- paste0("Gene_", 1:50)
colnames(expr_data) <- paste0("Cell_", 1:400)

# Create metadata
metadata <- data.frame(
  celltype = rep(c("T_cell", "B_cell"), each=200),
  Diagnosis = rep(c("IPF", "Control"), length.out=400)
)

cell_types <- c("T_cell", "B_cell")
conditions <- c("IPF", "Control")

# Comprehensive query
results <- query_signature_comprehensive(expr_data, cell_types, conditions, metadata)

}
