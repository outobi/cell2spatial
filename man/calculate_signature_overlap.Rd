% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Overlap_method.R
\name{calculate_signature_overlap}
\alias{calculate_signature_overlap}
\title{Calculate Region-Specific Gene Overlap with Cell-Type Gene Signatures}
\usage{
calculate_signature_overlap(
  region_signature_genes,
  cell_signature_list,
  universe_size,
  output_file = NULL
)
}
\arguments{
\item{region_signature_genes}{Character vector of gene symbols from region-specific
signature (e.g., genes from fibroblast foci, alveoli, etc.).}

\item{cell_signature_list}{A list where each element contains a character vector
of gene symbols for a specific cell type. Names of the list elements should be
cell type names.}

\item{universe_size}{Integer specifying the total number of genes in the universe
(background). Default: 24470 (typical for human transcriptome).}

\item{output_file}{Character string specifying the output file path for Excel export.
If NULL (default), no file is exported.}
}
\value{
A data frame containing overlap analysis results:
  \item{cell.type}{Cell type names from the input list}
  \item{overlap_count}{Number of overlapping genes between region signature and cell signature}
  \item{expected_overlap}{Expected number of overlapping genes by chance}
  \item{direction}{Either "enriched" or "depleted" based on comparison with expectation}
  \item{p.value}{P-value from hypergeometric test}
  \item{-log10(p.value)}{Negative log10 transformed p-value (always positive)}
  \item{p.value.with.direction}{Signed -log10(p.value): positive for enrichment, negative for depletion}
}
\description{
Performs hypergeometric test to assess enrichment or depletion of region-specific
genes within cell-type-specific gene signatures from single-cell RNA-seq data.
}
\details{
This function performs hypergeometric enrichment testing to determine whether
region-specific genes are significantly over-represented (enriched) or
under-represented (depleted) in cell-type-specific gene signatures.

The hypergeometric test is performed for each cell type signature:
- If overlap > expected: tests for enrichment (upper tail test)
- If overlap < expected: tests for depletion (lower tail test)

The hypergeometric probability is calculated as:
P(X = k) where X ~ Hypergeometric(N, K, n)
- N = universe_size (total genes)
- K = size of cell signature
- n = size of region signature
- k = observed overlap
}
\examples{
\dontrun{
# Example with fibroblast foci signature
ff_genes <- c("COL1A1", "COL1A2", "ACTA2", "FN1", "POSTN")

# Cell type signatures (list of gene vectors)
cell_signatures <- list(
  Fibroblasts = c("COL1A1", "COL3A1", "FN1", "DCN", "LUM"),
  Macrophages = c("CD68", "CD163", "MSR1", "MRC1", "MARCO"),
  T_cells = c("CD3D", "CD3E", "CD8A", "CD4", "IL7R")
)

# Calculate overlap
result <- calculate_signature_overlap(
  region_signature_genes = ff_genes,
  cell_signature_list = cell_signatures,
  universe_size,
  output_file = "ff_overlap_score.xlsx"
)

# View results
print(result)
}

}
