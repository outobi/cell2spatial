% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Cell_specific_gene.R
\name{t_test_compare_cell}
\alias{t_test_compare_cell}
\title{Compare Gene Expression Between Cell Types Using t-test}
\usage{
t_test_compare_cell(
  normalized_count,
  meta_data,
  target_cell_type,
  diagnosis,
  celltype_col = "celltype",
  diagnosis_col = "Diagnosis",
  min_samples = 3,
  correction_method = "Nominal"
)
}
\arguments{
\item{normalized_count}{A matrix or data frame of normalized gene expression counts
with genes as rows and samples as columns}

\item{meta_data}{A data frame containing sample metadata with columns for
cell type and diagnosis information}

\item{target_cell_type}{Character string specifying the target cell type for analysis}

\item{diagnosis}{Character string specifying the diagnosis condition (e.g., "IPF")}

\item{celltype_col}{Character string specifying the column name for cell type
in meta_data (default: "celltype")}

\item{diagnosis_col}{Character string specifying the column name for diagnosis
in meta_data (default: "Diagnosis")}

\item{min_samples}{Minimum number of samples required for analysis (default: 3)}

\item{correction_method}{Character string specifying multiple testing correction method.
Options: "BH" for Benjamini-Hochberg FDR correction, "Nominal" for no correction (default: "Nominal")}
}
\value{
A data frame containing:
  \item{index}{Gene index/row number}
  \item{gene_id}{Gene identifier (if available)}
  \item{d}{Cohen's d effect size}
  \item{stat.sig}{P-value from t-test (or FDR-adjusted p-value if correction_method = "BH")}
  \item{mean_target}{Mean expression in target cell type}
  \item{mean_non_target}{Mean expression in non-target cells}
  \item{n_target}{Number of target cell type samples}
  \item{n_non_target}{Number of non-target samples}
}
\description{
Performs comprehensive cell type-specific differential expression analysis
including t-tests and Cohen's d effect size calculations for spatial transcriptomics data.
}
\details{
This function performs differential expression analysis comparing a target cell type
against all other cell types within a specific diagnosis condition. It calculates
Cohen's d effect sizes and performs Welch's t-tests for each gene.

The analysis follows the methodology used in spatial transcriptomics studies
where target cell types are compared against reference populations to identify
cell type-specific gene expression patterns.
}
\examples{
\dontrun{
# Example with simulated data
set.seed(123)
# Create simulated expression data
expression_data <- matrix(rnorm(1000 * 50), nrow = 1000, ncol = 50)
rownames(expression_data) <- paste0("Gene_", 1:1000)
colnames(expression_data) <- paste0("Sample_", 1:50)

# Create metadata
metadata <- data.frame(
  celltype = rep(c("Fibroblasts", "Epithelial", "Immune"), c(20, 20, 10)),
  Diagnosis = rep("IPF", 50)
)

# Perform cell type comparison
result <- t_test_compare_cell(
  normalized_count = expression_data,
  meta_data = metadata,
  target_cell_type = "Fibroblasts",
  diagnosis = "IPF"
)
head(result)
}

}
