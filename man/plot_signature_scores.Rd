% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Plotting_functions.R
\name{plot_signature_scores}
\alias{plot_signature_scores}
\title{Create Signature Score Bubble Plot}
\usage{
plot_signature_scores(
  signature_data,
  plot_type = "positive",
  size_limits = NULL,
  size_range = NULL,
  size_breaks = NULL,
  sample_column = "Sample",
  title = NULL,
  x_label = "Condition",
  y_label = "Cell Type"
)
}
\arguments{
\item{signature_data}{A data.frame in wide format with cell types as rows and 
conditions as columns. Values represent signature scores.}

\item{plot_type}{Character string specifying plot type. Options:
"positive" (default): For positive signature scores (Figure 1D style)
"negative": For negative signature scores (Figure S3A style)}

\item{size_limits}{Numeric vector of length 2 specifying size scale limits.
Default: c(0, 160) for positive, c(-30, 0) for negative.}

\item{size_range}{Numeric vector of length 2 specifying bubble size range.
Default: c(1, 10) for positive, c(10, 1) for negative.}

\item{size_breaks}{Numeric vector specifying legend breaks for size scale.}

\item{sample_column}{Character string specifying column name containing cell types.
Default: "Sample" (assumes cell types are in a column named "Sample").}

\item{title}{Character string for plot title. Default: NULL (no title).}

\item{x_label}{Character string for x-axis label. Default: "Condition".}

\item{y_label}{Character string for y-axis label. Default: "Cell Type".}
}
\value{
A ggplot object that can be displayed or saved.
}
\description{
Creates a bubble plot to visualize gene signature scores across cell types and conditions.
This function converts wide format data to long format and creates publication-ready plots.
}
\details{
This function:
1. Converts wide format data to long format using reshape2::melt()
2. Creates a bubble plot where bubble size represents signature score magnitude
3. Provides different scaling for positive vs negative signature scores
4. Uses publication-ready formatting with bold text and clean theme
}
\examples{
# Create example signature data (wide format)
cell_types <- c("T Cells", "B Cells", "Macrophages", "Fibroblasts")
conditions <- c("Control alveoli", "IPF blood vessel", "IPF fibroblast foci")

# Positive signature scores
positive_data <- data.frame(
  Sample = cell_types,
  `Control alveoli` = c(50, 30, 80, 120),
  `IPF blood vessel` = c(60, 40, 90, 140),
  `IPF fibroblast foci` = c(70, 35, 95, 160),
  check.names = FALSE
)

# Create positive signature plot
p1 <- plot_signature_scores(positive_data, plot_type = "positive")

# Negative signature scores
negative_data <- data.frame(
  Sample = cell_types,
  `Control alveoli` = c(-10, -5, -20, -25),
  `IPF blood vessel` = c(-15, -8, -22, -28),
  `IPF fibroblast foci` = c(-12, -6, -18, -30),
  check.names = FALSE
)

# Create negative signature plot
p2 <- plot_signature_scores(negative_data, plot_type = "negative")

}
